<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Announcements ‚Äî Student</title>

  <style>
    :root { --card: rgba(255,255,255,0.55); --accent:#007aff; --muted:#666; }

    body {
      margin:0;
      font-family:-apple-system,"Inter",sans-serif;
      background:linear-gradient(135deg,#dbe8ff,#eef3ff,#ffffff);
      padding:36px 12px;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    h1 {
      font-size:28px;
      font-weight:600;
      display:flex;
      align-items:center;
      gap:10px;
    }
    h1::before { content:"üì¢"; font-size:29px; }

    .card {
      width:90%;
      max-width:900px;
      background:var(--card);
      backdrop-filter:blur(20px);
      padding:20px;
      border-radius:18px;
      box-shadow:0 8px 30px rgba(0,0,0,0.10);
      margin-top:20px;
    }

    .ann {
      background:white;
      padding:16px;
      border-radius:12px;
      margin-bottom:12px;
      box-shadow:0 6px 20px rgba(0,0,0,0.05);
    }

    h3 { margin:0; font-size:17px; }
    p { font-size:15px; margin:6px 0; }
    .timestamp { color:var(--muted); font-size:13px; margin-top:5px; }

    .empty {
      text-align:center;
      color:var(--muted);
      padding:20px;
    }

    a.home {
      text-decoration:none;
      color:var(--accent);
      margin-top:20px;
      font-weight:500;
    }
  </style>
</head>

<body>

  <h1>Announcements</h1>

  <div class="card">
    <div id="annList">Loading‚Ä¶</div>
  </div>

  <a href="index-student.html" class="home">‚Üê Back to Home</a>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB3Lv_9EiVBVy5aXwiYOn0pgZu31ykFOGM",
      authDomain: "digitalbellplisworkthistime.firebaseapp.com",
      databaseURL: "https://digitalbellplisworkthistime-default-rtdb.firebaseio.com",
      projectId: "digitalbellplisworkthistime",
      storageBucket: "digitalbellplisworkthistime.appspot.com",
      messagingSenderId: "829189847707",
      appId: "1:829189847707:web:99b13d5fe551b54d9ce43e"
    };

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    const db = firebase.database();
    const annList = document.getElementById("annList");

    db.ref("announcements")
      .orderByChild("timestamp")
      .on("value", snap => {
        annList.innerHTML = "";

        if (!snap.exists()) {
          annList.innerHTML = `<div class="empty">No announcements yet.</div>`;
          return;
        }

        const announcements = [];
        snap.forEach(child => {
          announcements.push(child.val());
        });

        announcements.reverse();

        announcements.forEach(a => {
          annList.insertAdjacentHTML("beforeend", `
            <div class="ann">
              <h3>${escapeHtml(a.title || "Untitled")}</h3>
              <p>${escapeHtml(a.message || "")}</p>
              <div class="timestamp">
                Posted by ${escapeHtml(a.postedBy || "Teacher")} ‚Ä¢ 
                ${a.timestamp ? new Date(a.timestamp).toLocaleString() : ""}
              </div>
            </div>
          `);
        });
      }, err => {
        console.error("Firebase read failed:", err);
        annList.innerHTML =
          `<div class="empty">Unable to load announcements.</div>`;
      });

    function escapeHtml(t) {
      return String(t ?? "")
        .replace(/[&<>]/g, c => ({
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;"
        }[c]));
    }
  </script>

</body>
</html>
