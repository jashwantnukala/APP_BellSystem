<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Announcements â€” Student</title>

  <style>
    body {
      margin:0;
      font-family:system-ui,-apple-system,Inter,sans-serif;
      background:#eef3ff;
      padding:32px;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    h1 { font-size:26px; margin-bottom:18px; }

    .card {
      width:100%;
      max-width:900px;
      background:white;
      padding:22px;
      border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.08);
    }

    .ann {
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:16px;
      margin-bottom:14px;
    }

    .ann h3 { margin:0 0 6px; font-size:17px; }
    .ann p { margin:0 0 6px; font-size:15px; }
    .time { font-size:13px; color:#6b7280; }

    .empty { color:#6b7280; text-align:center; padding:18px; }
  </style>
</head>

<body>

<h1>ðŸ“¢ Announcements</h1>

<div class="card" id="annList">Loadingâ€¦</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB3Lv_9EiVBVy5aXwiYOn0pgZu31ykFOGM",
    authDomain: "digitalbellplisworkthistime.firebaseapp.com",
    databaseURL: "https://digitalbellplisworkthistime-default-rtdb.firebaseio.com",
    projectId: "digitalbellplisworkthistime",
    storageBucket: "digitalbellplisworkthistime.firebasestorage.app",
    messagingSenderId: "829189847707",
    appId: "1:829189847707:web:99b13d5fe551b54d9ce43e"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const box = document.getElementById("annList");

  db.ref("announcements").on("value", snap => {
    box.innerHTML = "";

    if (!snap.exists()) {
      box.innerHTML = `<div class="empty">No announcements available.</div>`;
      return;
    }

    const items = [];

    snap.forEach(child => {
      const v = child.val() || {};
      items.push({
        title: v.title || "Untitled",
        message: v.message || "",
        postedBy: v.postedBy || "Teacher",
        timestamp: v.timestamp || 0
      });
    });

    items
      .sort((a,b) => b.timestamp - a.timestamp)
      .forEach(a => {
        const timeText = a.timestamp
          ? new Date(a.timestamp).toLocaleString()
          : "Time not available";

        box.insertAdjacentHTML("beforeend", `
          <div class="ann">
            <h3>${escape(a.title)}</h3>
            <p>${escape(a.message)}</p>
            <div class="time">Posted by ${escape(a.postedBy)} â€¢ ${timeText}</div>
          </div>
        `);
      });
  });

  function escape(t) {
    return String(t).replace(/[&<>]/g,c=>({
      "&":"&amp;","<":"&lt;",">":"&gt;"
    }[c]));
  }
</script>

</body>
</html>
